<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>pandadata.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id="background"></div>
<div id='container'>
  <div class='section'>
    <div class='docs'><h1>pandadata.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <h2>outline - pandas</h2>
<p>FUNCS   <br>
def alerts, time-normalized/smooth  <br>
PLOTS: hist. scatter.   <br>
MODELS:     <br>
clusters- delta between clusters    <br>
generative  <br></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>mean(), sem(), var()</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <h2>refs</h2>
<p>http://www.bearrelroll.com/2013/05/python-pandas-tutorial/  <br>
http://www.randalolson.com/2012/08/06/statistical-analysis-made-easy-in-python/ <br>
http://bytefish.de/blog/using_libsvm/   <br>
http://nbviewer.ipython.org/urls/gist.github.com/wesm/5773719/raw/1399562c0a02b9edc3d13c71a70387a31d87260b/tutorial.ipynb</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <script type="text/javascript" src="jquery-latest.min.js"></script>

<p><link href="knowlstyle.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="knowl.js"></script></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">score</span> <span class="kn">import</span> <span class="n">score</span> <span class="k">as</span> <span class="n">scr</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>write to csv read from csv</p>
<p>panda:</p>
<p>dataframe like spreadsheet
index is row-name : patient IDS
columns is col-name : vitalsigns</p>
<p>series is 1-d
index is axis-label</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>what</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">pandarnkci</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">frame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c">#load data</span>
		<span class="k">pass</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">s5</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c">#summary stat</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>plot the indicator funct</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="k">pass</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">indctr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">pltheic</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>track points, label each as hard or easy based on if entropy weight cutoff</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">heic</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>plot the he</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">pltheic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>how</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">pndsa</span><span class="p">(</span><span class="n">scr</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">scr</span><span class="p">):</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">scr</span><span class="o">.</span><span class="n">data</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">inc</span> <span class="o">=</span> <span class="n">scr</span><span class="o">.</span><span class="n">inc</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ent</span> <span class="o">=</span>  <span class="n">scr</span><span class="o">.</span><span class="n">entbys</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">None</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <h2>load score object.  create data frame.</h2>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">loads</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
 		<span class="s">&quot;init&quot;</span>
		<span class="s">&quot;get scr attributes&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>data = scr.data #[vitals,alerts,readings]
inc = scr.inc 
ent = scr.entbys</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		
 		<span class="s">&quot; generate patient IDs&quot;</span>
  		<span class="n">pdln</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">patientID</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">pdln</span><span class="p">)</span> <span class="p">]</span>
		<span class="k">print</span> <span class="s">&#39;frame load from csv: &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">patientID</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
		
		<span class="s">&quot; open csv import &quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>csv excel mysql</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;SYS&#39;</span><span class="p">,</span><span class="s">&#39;DIA&#39;</span><span class="p">,</span><span class="s">&#39;HR1&#39;</span><span class="p">,</span><span class="s">&#39;OX&#39;</span><span class="p">,</span><span class="s">&#39;HR2&#39;</span><span class="p">,</span><span class="s">&#39;WHT&#39;</span><span class="p">,</span><span class="s">&#39;alert&#39;</span><span class="p">]</span>
		<span class="k">print</span> <span class="s">&#39;header&#39;</span><span class="p">,</span> <span class="n">header</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>read csv into data frame</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">&#39;pandacsv.csv&#39;</span><span class="p">)</span>
		<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">header</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span>
	
		<span class="s">&quot;general&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>if take subset, then reindex to select data by first reindex, and then use ix to select by some criteria/value</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="s">&quot;rename columns inplace&quot;</span> 
		<span class="s">&quot;rename()&quot;</span>
		<span class="s">&quot;indexing, if not specified default given&quot;</span> 
		<span class="s">&quot;set_index()&quot;</span>
		<span class="s">&quot;reset_index()&quot;</span>
		<span class="k">print</span> <span class="n">df</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <p>summary</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="k">print</span> <span class="s">&#39;describe&#39;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span> <span class="c">#summary stat</span>
		<span class="n">df</span><span class="o">.</span><span class="n">index</span>
		<span class="n">df</span><span class="o">.</span><span class="n">count</span>
		<span class="k">print</span> <span class="s">&#39;head&#39;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <h2>time-series</h2>
<p>The assumption underlying stationary data is that mean and variance does not change.  So can do z-score normalization on new data with mean and variance from training data.  Need to separate out by sex, geography.  Can figure out time_of_day?</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">pandaZ</span><span class="p">(</span><span class="n">scr</span><span class="p">):</span>
		<span class="k">pass</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <h2>alerts</h2>
<p>This function gets alerts for the single/static and sequential (2,3).  Outputs should be histogram of sequence type by group(sex,geography).  An argument parameter should be what to group on.  This includes age, geography, or count ranking.  </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">alert</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="s">&quot;normalized&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p>normalized = 
grouped = normalized.groupby(level=[grp], axis=1)   </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="s">&quot;set keys and groups&quot;</span>
		<span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;SYS&#39;</span><span class="p">,</span><span class="s">&#39;DIA&#39;</span><span class="p">,</span><span class="s">&#39;HR1&#39;</span><span class="p">,</span><span class="s">&#39;OX&#39;</span><span class="p">,</span><span class="s">&#39;HR2&#39;</span><span class="p">,</span><span class="s">&#39;WHT&#39;</span><span class="p">]</span>
		<span class="n">grp</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;sex&#39;</span><span class="p">,</span> <span class="s">&#39;a123&#39;</span><span class="p">]</span>
		
		<span class="s">&quot;confidence interval&quot;</span>
		<span class="n">means</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">keys</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
		<span class="n">ci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">keys</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1.96</span><span class="p">)</span>
	
		<span class="s">&quot; alert &quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>df['a1'] = df[ df['SYS','DIA','HR1','OX','HR2','WHT'] &gt; ci ]</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>		<span class="n">df</span><span class="p">[</span><span class="s">&#39;a1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span> <span class="n">df</span><span class="p">[</span> <span class="n">keys</span> <span class="p">]</span> <span class="o">&gt;</span> <span class="n">ci</span> <span class="p">]</span>
		<span class="s">&quot;set multi-index&quot;</span>
	
		<span class="s">&quot;table output by group&quot;</span>
		<span class="n">grouped</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">grp</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s">&#39;count&#39;</span><span class="p">,</span><span class="s">&#39;min&#39;</span><span class="p">,</span><span class="s">&#39;max&#39;</span><span class="p">,</span><span class="s">&#39;mean&#39;</span><span class="p">])</span>
		<span class="n">result</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>	<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">pass</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p>http://www.hselab.org/machinery/content/getting-started-python-pandas-and-matplotlib-group-analysis</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">pandamimic</span><span class="p">(</span> <span class="n">mimic</span> <span class="p">):</span>
	<span class="k">pass</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">pandaboost</span><span class="p">(</span> <span class="p">)</span> <span class="p">:</span> <span class="k">pass</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
